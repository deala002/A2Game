<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Meeting Timer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script>

    var timerInterval = setInterval(null, 0);
    var savedTime = 0;
    var originalTime = 0;
    var currentTime = 0;
    var numSubTasks = 0;

    //Initate the start time of the timer
    function initiateCountdown() {
      //Clear previously running timer
      clearInterval(timerInterval);

      //Get current time to set as reference point
      var startpoint = new Date().getTime();

      //Get time to set to from input
      var minutesInput = document.getElementById("minutesInput");


      if (minutesInput.value != "")
        mOffset = minutesInput.value;
      else
        mOffset = '0';

      //Clear textboxes on screen
      minutesInput.value = "";

      //Calculate total time based of hours minutes and seconds 
      var totalOffset = JSON.parse(mOffset) * 60000;

      //Initate countdown function from specified time
      if (totalOffset > 0) {
        originalTime = totalOffset;
        savedTime = totalOffset;
        timerInterval = setInterval(function () { countDown(totalOffset, startpoint) }, 100);
      }
      else //Initiate countdown function from last set time if no time is specified
        timerInterval = setInterval(function () { countDown(savedTime, startpoint) }, 100);
    }

    function pauseCountdown() {
      clearInterval(timerInterval);

      savedTime = currentTime;
    }

    function resetCountdown() {
      clearInterval(timerInterval);

      savedTime = originalTime;

      var startpoint = new Date().getTime();
      countDown(originalTime, startpoint);
    }

    // Update count down each second
    function countDown(offset, startpoint) {
      // Update date and time to reference against original time
      var now = new Date().getTime();

      // Find the distance between now and reference date, adding in offset to count down from
      var distance = ((startpoint + offset) - now);

      currentTime = distance;

      // Calculate hours, minutes and seconds
      var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      var seconds = Math.floor((distance % (1000 * 60)) / 1000);

      // Display the result to screen
      document.getElementById("counter").innerHTML = hours + ":"
        + minutes + ":" + seconds;

      // Notify user if countdown complete
      if (distance < 0) {
        clearInterval(timerInterval);
        document.getElementById("counter").innerHTML = "COMPLETED";
      }
    }

    function addTask()
    {
      numSubTasks++;
            
      // Retrieve the container tot add sub-tasks to
      var tasksContainer = document.getElementById("tasksContainer");

      // Append a node with a random text
      tasksContainer.appendChild(document.createTextNode("Sub task " + (numSubTasks) + " "));
      
      // Create two input elements
      var taskNameInput = document.createElement("input");
      var mInput = document.createElement("input");

      //Set type, placeholder and id of taskNameInput
      taskNameInput.type = "Text";
      taskNameInput.placeholder = "Task name";
      taskNameInput.id = "taskName" + numSubTasks-1;

      //Set type, placeholder and id of timer
      mInput.type = "number";
      mInput.id = "taskTime" + numSubTasks-1;
      mInput.placeholder = "Minutes";

      tasksContainer.appendChild(taskNameInput);
      tasksContainer.appendChild(mInput);
      
      // Append a line break 
      tasksContainer.appendChild(document.createElement("br")); 
    }

    function importTask() {

    }

    function exportTask() {

    }

    function pauseTask() {

    }

  </script>
</head>

<body>
  <h1>Meeting timer</h1>
  <p id="counter"></p>
  <div class="center_div">
    <form>
      <input id="taskName" type="text" placeholder="Task Name">
      <input id="minutesInput" type="number" placeholder="Minutes">
      <button type="button" onclick="initiateCountdown()">Start</button>
      <button type="button" onclick="pauseCountdown()">Pause</button>
      <button type="button" onclick="resetCountdown()">Reset</button>
    </form>
  </div>
  <div class="center_div">
    <form>
      <button type="button" onclick="addTask()">Add Task</button>
    </form>
  </div>
  <div id="tasksContainer" class="center_div">
    <form>
      
    </form>
  </div>
</body>

</html>